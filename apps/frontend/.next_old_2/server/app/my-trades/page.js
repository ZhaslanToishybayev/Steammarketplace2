(()=>{var e={};e.id=409,e.ids=[409],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5826:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>c});var r=a(7096),s=a(6132),n=a(7284),i=a.n(n),l=a(2564),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);a.d(t,d);let c=["",{children:["my-trades",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,8519)),"/home/zhaslan/Downloads/Telegram Desktop/Steammarketplace2-main (2)/Steammarketplace2-main/apps/frontend/src/app/my-trades/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,769)),"/home/zhaslan/Downloads/Telegram Desktop/Steammarketplace2-main (2)/Steammarketplace2-main/apps/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["/home/zhaslan/Downloads/Telegram Desktop/Steammarketplace2-main (2)/Steammarketplace2-main/apps/frontend/src/app/my-trades/page.tsx"],u="/my-trades/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/my-trades/page",pathname:"/my-trades",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},438:(e,t,a)=>{Promise.resolve().then(a.bind(a,2218))},2218:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(3854),s=a(4218),n=a(3843);function i(){let[e,t]=(0,s.useState)(void 0),[a,i]=(0,s.useState)(void 0),{data:l,isLoading:d,error:c}=(0,n.KN)({status:e,role:a});return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900",children:[r.jsx("header",{className:"border-b border-gray-700 bg-gray-900/50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-white",children:"\uD83D\uDCCB Мои сделки"}),r.jsx("p",{className:"text-gray-400 mt-1",children:"История escrow сделок"})]})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[r.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 mb-6 border border-gray-700",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>i(void 0),className:`px-4 py-2 rounded-lg transition ${a?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-blue-600 text-white"}`,children:"Все"}),r.jsx("button",{onClick:()=>i("buyer"),className:`px-4 py-2 rounded-lg transition ${"buyer"===a?"bg-green-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"\uD83D\uDED2 Покупки"}),r.jsx("button",{onClick:()=>i("seller"),className:`px-4 py-2 rounded-lg transition ${"seller"===a?"bg-purple-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"\uD83D\uDCB0 Продажи"})]}),r.jsx("select",{value:e||"",onChange:e=>t(e.target.value||void 0),className:"bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:void 0,label:"Все статусы"},{value:"pending_payment",label:"\uD83D\uDCB0 Ожидание оплаты"},{value:"awaiting_seller",label:"\uD83D\uDCE6 Ожидание продавца"},{value:"awaiting_buyer",label:"\uD83C\uDF81 Ожидание покупателя"},{value:"completed",label:"✅ Завершено"},{value:"cancelled",label:"❌ Отменено"}].map(e=>r.jsx("option",{value:e.value||"",children:e.label},e.value||"all"))})]})}),d&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto"}),r.jsx("p",{className:"text-gray-400 mt-4",children:"Загрузка сделок..."})]}),c&&r.jsx("div",{className:"text-center py-12",children:(0,r.jsxs)("p",{className:"text-red-400",children:["Ошибка: ",c.message]})}),l?.data&&r.jsx("div",{className:"space-y-4",children:l.data.map(e=>{let t=(0,n.e7)(e.status);return(0,r.jsxs)("div",{className:"bg-gray-800/70 rounded-xl p-4 border border-gray-700 hover:border-gray-600 transition",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-900/50 rounded-lg flex items-center justify-center",children:e.item_icon_url?r.jsx("img",{src:e.item_icon_url,alt:e.item_name,className:"w-12 h-12 object-contain"}):r.jsx("span",{className:"text-2xl",children:"\uD83C\uDFAE"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("h3",{className:"text-white font-semibold",children:e.item_name}),r.jsx("span",{className:`px-2 py-0.5 rounded text-xs text-white ${"buyer"===e.role?"bg-green-600":"bg-purple-600"}`,children:"buyer"===e.role?"Покупка":"Продажа"})]}),(0,r.jsxs)("p",{className:"text-gray-400 text-sm mt-1",children:["Trade #",e.trade_uuid.slice(0,8)]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-xl font-bold text-green-400",children:["$",Number(e.price).toFixed(2)]}),r.jsx("p",{className:"text-gray-500 text-sm",children:new Date(e.created_at).toLocaleDateString("ru-RU")})]}),r.jsx("div",{className:"text-right min-w-[120px]",children:r.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm text-white ${t.color}`,children:n.ei[e.status]||e.status})}),r.jsx("a",{href:`/trade/${e.trade_uuid}`,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition",children:"Подробнее →"})]}),t.isActive&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[r.jsx("span",{children:"Прогресс сделки"}),r.jsx("span",{children:n.ei[e.status]})]}),r.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:r.jsx("div",{className:`h-full ${t.color} transition-all`,style:{width:{pending_payment:"10%",payment_received:"25%",awaiting_seller:"40%",seller_accepted:"55%",awaiting_buyer:"70%",buyer_accepted:"85%",completed:"100%"}[e.status]||"0%"}})})]})]},e.trade_uuid)})}),l?.data?.length===0&&(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx("p",{className:"text-gray-400 text-lg",children:"Нет сделок"}),r.jsx("p",{className:"text-gray-500 mt-2",children:r.jsx("a",{href:"/marketplace",className:"text-blue-400 hover:underline",children:"Перейти на маркетплейс →"})})]})]})]})}},3843:(e,t,a)=>{"use strict";a.d(t,{AB:()=>u,KN:()=>c,Y7:()=>p,e7:()=>x,ei:()=>m,lZ:()=>o});var r=a(156),s=a(6214),n=a(632),i=a(4218);let l="http://localhost:3001",d={getListings:async e=>{let t=new URLSearchParams;e&&Object.entries(e).forEach(([e,a])=>{void 0!==a&&t.set(e,String(a))});let a=await fetch(`${l}/api/escrow/listings?${t}`,{credentials:"include"});return a.json()},getListing:async e=>{let t=await fetch(`${l}/api/escrow/listings/${e}`,{credentials:"include"});return t.json()},createListing:async e=>{let t=await fetch(`${l}/api/escrow/listings`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});return t.json()},deleteListing:async e=>{let t=await fetch(`${l}/api/escrow/listings/${e}`,{method:"DELETE",credentials:"include"});return t.json()},getTrades:async e=>{let t=new URLSearchParams;e&&Object.entries(e).forEach(([e,a])=>{void 0!==a&&t.set(e,String(a))});let a=await fetch(`${l}/api/escrow/trades?${t}`,{credentials:"include"});return a.json()},getTrade:async e=>{let t=await fetch(`${l}/api/escrow/trades/${e}`,{credentials:"include"});return t.json()},buyListing:async e=>{let t=await fetch(`${l}/api/escrow/buy/${e}`,{method:"POST",credentials:"include"});return t.json()},payTrade:async(e,t)=>{let a=await fetch(`${l}/api/escrow/trades/${e}/pay`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});return a.json()},cancelTrade:async(e,t)=>{let a=await fetch(`${l}/api/escrow/trades/${e}/cancel`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({reason:t})});return a.json()},getBotStatus:async()=>{let e=await fetch(`${l}/api/escrow/bots/status`,{credentials:"include"});return e.json()}};function c(e){return(0,r.a)({queryKey:["escrow","trades",e],queryFn:()=>d.getTrades(e)})}function o(e){let t=(0,s.NL)();return(0,i.useEffect)(()=>{if(e)return()=>{}},[e,t]),(0,r.a)({queryKey:["escrow","trade",e],queryFn:()=>d.getTrade(e),enabled:!!e,refetchInterval:1e4})}function u(){let e=(0,s.NL)();return(0,n.D)({mutationFn:({tradeUuid:e,paymentData:t})=>d.payTrade(e,t),onSuccess:(t,{tradeUuid:a})=>{e.invalidateQueries({queryKey:["escrow","trade",a]}),e.invalidateQueries({queryKey:["escrow","trades"]})}})}function p(){let e=(0,s.NL)();return(0,n.D)({mutationFn:({tradeUuid:e,reason:t})=>d.cancelTrade(e,t),onSuccess:(t,{tradeUuid:a})=>{e.invalidateQueries({queryKey:["escrow","trade",a]}),e.invalidateQueries({queryKey:["escrow","trades"]})}})}let m={pending_payment:"Ожидание оплаты",payment_received:"Оплата получена",awaiting_seller:"Ожидание продавца",seller_accepted:"Продавец подтвердил",awaiting_buyer:"Ожидание покупателя",buyer_accepted:"Покупатель подтвердил",completed:"Завершено",cancelled:"Отменено",refunded:"Возврат средств",disputed:"Спор",expired:"Истекло",error_sending:"Ошибка отправки"},g={pending_payment:"bg-yellow-500",payment_received:"bg-blue-500",awaiting_seller:"bg-orange-500",seller_accepted:"bg-cyan-500",awaiting_buyer:"bg-purple-500",buyer_accepted:"bg-indigo-500",completed:"bg-green-500",cancelled:"bg-gray-500",refunded:"bg-red-500",disputed:"bg-red-600",expired:"bg-gray-400"};function x(e){return{label:m[e]||e,color:g[e]||"bg-gray-500",isActive:!["completed","cancelled","refunded","expired"].includes(e),isSuccess:"completed"===e,isError:["cancelled","refunded","disputed","expired"].includes(e)}}},8519:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>d});var r=a(5153);let s=(0,r.createProxy)(String.raw`/home/zhaslan/Downloads/Telegram Desktop/Steammarketplace2-main (2)/Steammarketplace2-main/apps/frontend/src/app/my-trades/page.tsx`),{__esModule:n,$$typeof:i}=s,l=s.default,d=l}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[581,342,919],()=>a(5826));module.exports=r})();