"use strict";exports.id=308,exports.ids=[308],exports.modules={6384:(e,t,r)=>{r.d(t,{i:()=>l});var a=r(4218),n=r(2828),s=r(9543),o=r(931);function l(e){let{appId:t,enabled:r=!0,refetchInterval:l,retryOnFailure:i=!0}=e,[c,u]=(0,a.useState)(null),[h,f]=(0,a.useState)(!1),[m,d]=(0,a.useState)(null),[g,p]=(0,a.useState)(0),y=o.c.getSteamId();s.z.hasRecentCache(y||"anonymous",t),s.z.getCacheAge(y||"anonymous",t),s.z.hasRecentCache(y||"anonymous",t);let C=(0,a.useCallback)(async(e=!1)=>{if(!r||!y){d("Not authenticated");return}f(!0);let a=performance.now();try{let r;let o=`${y}:${t}`,l=y?`?steamid=${encodeURIComponent(y)}`:"";if(!e){let e=s.z.getInventory(y,t,l);if(e){u(e),d(null);let t=performance.now();p(t-a),console.log(`ðŸ“¦ Using cached inventory (${t-a}ms)`);return}}if(console.log(`ðŸŒ Fetching fresh inventory for ${o}`),730===t)r=await n.x.getCs2Inventory();else if(570===t)r=await n.x.getDotaInventory();else throw Error(`Unsupported app ID: ${t}`);if(r.success)s.z.setInventory(y,t,r,void 0,l),u(r),d(null);else{d(r.error||"Failed to fetch inventory");let e=s.z.getInventory(y,t,l);e&&(u(e),console.warn("\uD83D\uDCE6 Using stale cache due to API error"))}}catch(e){if(console.error("âŒ Failed to fetch inventory:",e),d(e.message||"Network error"),i){let e=s.z.getInventory(y,t,y?`?steamid=${encodeURIComponent(y)}`:"");e&&(u(e),console.warn("\uD83D\uDCE6 Using cached data due to error"))}}finally{let e=performance.now();p(e-a),f(!1)}},[y,t,r,i]),v=(0,a.useCallback)(async()=>{await C(!0)},[C]),w=(0,a.useCallback)(()=>{y&&(s.z.invalidateInventory(y,t),console.log(`ðŸ“¦ Cache invalidated for ${y}:${t}`))},[y,t]),S=(0,a.useCallback)(()=>{s.z.clear(),console.log("\uD83D\uDCE6 All cache cleared")},[]);return(0,a.useEffect)(()=>{r&&y&&C()},[C,r,y]),(0,a.useEffect)(()=>{if(!l||!r||!y)return;let e=setInterval(()=>{console.log(`ðŸ”„ Auto-refreshing inventory for app ${t}`),C(!0)},l);return()=>clearInterval(e)},[l,r,y,t,C]),(0,a.useEffect)(()=>()=>{},[]),{inventory:c,isLoading:h,error:m,refetch:v,invalidateCache:w,clearCache:S,cacheStatus:{hasCache:s.z.hasRecentCache(y||"anonymous",t),cacheAge:s.z.getCacheAge(y||"anonymous",t),isCacheValid:s.z.hasRecentCache(y||"anonymous",t)},stats:{totalItems:c?.items?.length||0,loadingTime:g}}}},8175:(e,t,r)=>{r.d(t,{FV:()=>f,g_:()=>l,a4:()=>i,B8:()=>c,$b:()=>u,dd:()=>h});var a=r(4218);let n={defaultTTL:3e4,maxSize:100,cleanupInterval:6e4};class s{constructor(e={}){this.cache=new Map,this.cleanupTimer=null,this.config={...n,...e},this.startCleanupTimer()}generateKey(e,t){let r=JSON.stringify(t);return`${e}:${r}`}isEntryValid(e){let t=Date.now();return t-e.timestamp<e.ttl}get(e,t){let r=this.generateKey(e,t),a=this.cache.get(r);return a?this.isEntryValid(a)?(console.log(`ðŸ§® Cache HIT for ${e}`),a.value):(console.log(`ðŸ§® Cache EXPIRED for ${e}`),this.cache.delete(r),null):(console.log(`ðŸ§® Cache MISS for ${e}`),null)}set(e,t,r,a){let n=this.generateKey(e,t),s=a||this.config.defaultTTL,o={key:n,value:r,timestamp:Date.now(),ttl:s};this.cache.size>=this.config.maxSize&&this.evictOldest(),this.cache.set(n,o),console.log(`ðŸ§® Cache SET for ${e} (TTL: ${s}ms)`)}evictOldest(){let e=null,t=Date.now();for(let[r,a]of this.cache.entries())a.timestamp<t&&(t=a.timestamp,e=r);e&&(this.cache.delete(e),console.log(`ðŸ§® Evicted oldest cache entry: ${e}`))}clear(){this.cache.clear(),console.log(`ðŸ§® Cache CLEARED`)}getStats(){let e={size:this.cache.size,maxSize:this.config.maxSize,entries:[]},t=Date.now();for(let[r,a]of this.cache.entries())e.entries.push({key:r,age:t-a.timestamp,ttl:a.ttl,valid:this.isEntryValid(a)});return e}startCleanupTimer(){this.cleanupTimer&&clearInterval(this.cleanupTimer),this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval),console.log(`ðŸ§¹ Memoization cleanup timer started (interval: ${this.config.cleanupInterval}ms)`)}stopCleanupTimer(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}cleanup(){this.cache.size;let e=Date.now(),t=[];for(let[r,a]of this.cache.entries())e-a.timestamp>=a.ttl&&t.push(r);if(t.forEach(e=>this.cache.delete(e)),t.length>0&&console.log(`ðŸ§¹ Cleaned up ${t.length} expired memoization entries`),this.cache.size>this.config.maxSize){let e=this.cache.size-this.config.maxSize;for(let t=0;t<e;t++)this.evictOldest();console.log(`ðŸ§¹ Evicted ${e} oldest entries due to size limit`)}}}let o=new s({defaultTTL:3e4,maxSize:100,cleanupInterval:6e4});function l(e,t){return(0,a.useMemo)(()=>{JSON.stringify(t);let r=o.get("filterInventory",[e,t]);if(r)return r;let a=e.filter(e=>{if(t.search){let r=t.search.toLowerCase(),a=e.name.toLowerCase().includes(r)||e.market_hash_name.toLowerCase().includes(r);if(!a)return!1}if(void 0!==t.tradable&&e.tradable!==t.tradable||void 0!==t.marketable&&e.marketable!==t.marketable)return!1;if(t.type&&t.type.length>0){let r=m(e).toLowerCase();if(!t.type.some(e=>r.includes(e.toLowerCase())))return!1}if(t.rarity&&t.rarity.length>0){let r=d(e).toLowerCase();if(!t.rarity.some(e=>r.includes(e.toLowerCase())))return!1}if(t.exterior&&t.exterior.length>0){let r=g(e).toLowerCase();if(!t.exterior.some(e=>r.includes(e.toLowerCase())))return!1}return!0});return o.set("filterInventory",[e,t],a),a},[e,t])}function i(e,t){return(0,a.useMemo)(()=>{JSON.stringify(t);let r=o.get("sortInventory",[e,t]);if(r)return r;let a=[...e].sort((e,r)=>{let a,n;switch(t.field){case"name":default:a=e.name.toLowerCase(),n=r.name.toLowerCase();break;case"type":a=m(e).toLowerCase(),n=m(r).toLowerCase();break;case"rarity":a=d(e).toLowerCase(),n=d(r).toLowerCase();break;case"tradable":a=e.tradable?1:0,n=r.tradable?1:0;break;case"marketable":a=e.marketable?1:0,n=r.marketable?1:0}return a<n?"asc"===t.direction?-1:1:a>n?"asc"===t.direction?1:-1:0});return o.set("sortInventory",[e,t],a),a},[e,t])}function c(e){return(0,a.useMemo)(()=>{e.length;let t=o.get("computeMetadata",[e]);if(t)return t;let r={total:e.length,tradable:e.filter(e=>e.tradable).length,marketable:e.filter(e=>e.marketable).length,types:new Set,rarities:new Set,exteriors:new Set};e.forEach(e=>{let t=m(e),a=d(e),n=g(e);t&&r.types.add(t),a&&r.rarities.add(a),n&&r.exteriors.add(n)});let a={...r,types:Array.from(r.types),rarities:Array.from(r.rarities),exteriors:Array.from(r.exteriors)};return o.set("computeMetadata",[e],a),a},[e])}function u(e,t){return(0,a.useMemo)(()=>{if(!t||t.length<2)return[];let r=o.get("searchSuggestions",[e,t]);if(r)return r;let a=new Set,n=t.toLowerCase();e.forEach(e=>{e.name.toLowerCase().includes(n)&&a.add(e.name),e.market_hash_name.toLowerCase().includes(n)&&a.add(e.market_hash_name)});let s=Array.from(a).slice(0,10);return o.set("searchSuggestions",[e,t],s,6e4),s},[e,t])}function h(e){return(0,a.useMemo)(()=>{e.length;let t=o.get("calculateStatistics",[e]);if(t)return t;let r=e.reduce((e,t)=>{let r=m(t)||"Unknown";return e[r]=(e[r]||0)+1,e},{}),a=e.reduce((e,t)=>{let r=d(t)||"Unknown";return e[r]=(e[r]||0)+1,e},{}),n={groupedByType:r,groupedByRarity:a,mostCommonType:Object.entries(r).sort((e,t)=>t[1]-e[1])[0]?.[0]||"None",mostCommonRarity:Object.entries(a).sort((e,t)=>t[1]-e[1])[0]?.[0]||"None"};return o.set("calculateStatistics",[e],n,3e5),n},[e])}function f(){let[e,t]=useState(o.getStats());(0,a.useEffect)(()=>{let e=setInterval(()=>{t(o.getStats())},5e3);return()=>clearInterval(e)},[]);let r=(0,a.useCallback)(()=>{o.clear(),t(o.getStats())},[]),n=(0,a.useCallback)(()=>{t(o.getStats())},[]);return{stats:e,clearCache:r,refreshStats:n}}function m(e){let t=e?.descriptions||[],r=t.find(e=>String(e.type||"").toLowerCase().includes("type"))?.value;return r||e.type||""}function d(e){let t=e?.descriptions||[],r=t.find(e=>String(e.type||"").toLowerCase().includes("rarity"))?.value;return r||""}function g(e){let t=e?.descriptions||[],r=t.find(e=>String(e.type||"").toLowerCase().includes("exterior"))?.value;return r||""}}};