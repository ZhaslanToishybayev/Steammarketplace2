# üéÆ Steam Marketplace ‚Äî –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –∫—Ä–∞—Ç–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É. –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω–æ, —á—Ç–æ —ç—Ç–æ –∑–∞ —Å–∞–π—Ç, –∫–∞–∫ –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ —á—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ.

---

## üì¶ –ß—Ç–æ —ç—Ç–æ?

–≠—Ç–æ **–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å —Å–∫–∏–Ω–æ–≤ CS2**, –ø–æ—Ö–æ–∂–∏–π –Ω–∞ cs.money –∏–ª–∏ DMarket.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–æ–≥–∏–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ Steam.
- –ú–æ–∂–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å —Å–∫–∏–Ω—ã –∑–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –±–∞–ª–∞–Ω—Å.
- –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–µ–π–¥-–æ—Ñ—Ñ–µ—Ä –≤ Steam.
- –ï—Å—Ç—å –∫–æ—Ä–∑–∏–Ω–∞, –∏—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫, –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/apps
  /backend    ‚Äî Node.js + Express —Å–µ—Ä–≤–µ—Ä (API, Steam –±–æ—Ç—ã, –ë–î)
  /frontend   ‚Äî Next.js —Å–∞–π—Ç (React, TypeScript)
```

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd apps/backend && npm install
cd ../frontend && npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` –≤ `apps/backend/`:

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
DATABASE_URL=postgresql://postgres:password@localhost:5432/steam_marketplace

# Steam API
STEAM_API_KEY=—Ç–≤–æ–π_–∫–ª—é—á_steam
STEAM_RETURN_URL=http://localhost:3001/auth/steam/return
STEAM_REALM=http://localhost:3001/

# –ë–æ—Ç—ã (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ)
STEAM_BOT_1_ACCOUNT_NAME=–ª–æ–≥–∏–Ω_–∞–∫–∫–∞—É–Ω—Ç–∞
STEAM_BOT_1_PASSWORD=–ø–∞—Ä–æ–ª—å
STEAM_BOT_1_SHARED_SECRET=—Å–µ–∫—Ä–µ—Ç_2FA
STEAM_BOT_1_IDENTITY_SECRET=—Å–µ–∫—Ä–µ—Ç_–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
STEAM_BOT_1_STEAM_ID=76561198xxxxxxxxx

# –§—Ä–æ–Ω—Ç–µ–Ω–¥
FRONTEND_URL=http://localhost:3000
SESSION_SECRET=–ª—é–±–∞—è_–¥–ª–∏–Ω–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞
```

–í `apps/frontend/` —Å–æ–∑–¥–∞–π `.env.local`:

```env
NEXT_PUBLIC_BACKEND_URL=http://localhost:3001
```

### 3. –ó–∞–ø—É—Å—Ç–∏ PostgreSQL

–£–±–µ–¥–∏—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `steam_marketplace` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

```bash
# –°–æ–∑–¥–∞–π –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb -h localhost -U postgres steam_marketplace
```

### 4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚ö†Ô∏è –í–ê–ñ–ù–û

–í –∞—Ä—Ö–∏–≤–µ –µ—Å—Ç—å —Ñ–∞–π–ª `database_schema.sql` ‚Äî —ç—Ç–æ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã.

```bash
# –ù–∞–∫–∞—Ç–∏ —Å—Ö–µ–º—É
psql -h localhost -U postgres steam_marketplace < database_schema.sql
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ (–æ–Ω–∏ –ª–µ–∂–∞—Ç –≤ `apps/backend/migrations/`):

```bash
cd apps/backend
node scripts/run_migrations.js
```

### 5. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: Backend
cd apps/backend && node src/server.js

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: Frontend
cd apps/frontend && npm run dev
```

–û—Ç–∫—Ä–æ–π http://localhost:3000

---

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ (–∫—Ä–∞—Ç–∫–∏–π –ª–æ–≥)

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—á–∏
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Steam** ‚Äî Passport.js + OpenID
- **–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –±–æ—Ç–∞** ‚Äî —Å–∫–∏–Ω—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ –ë–î
- **–ü–æ–∫—É–ø–∫–∞ —Å–∫–∏–Ω–æ–≤** ‚Äî –±–∞–ª–∞–Ω—Å —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ñ—Ñ–µ—Ä
- **–ö–æ—Ä–∑–∏–Ω–∞** ‚Äî –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∫–∏–Ω–æ–≤ –∑–∞ —Ä–∞–∑
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–¥–µ–ª–∫–∏** ‚Äî —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∞–≥–∏
- **–ü—É—Å—Ç–∞—è –±–∞–∑–∞ –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** ‚Äî –±—ã–ª–∞ –æ–ø–µ—á–∞—Ç–∫–∞ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –∫–æ–ª–æ–Ω–∫–∏ (`listing_status` ‚Üí `status`)
- **–ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è –Ω–∏–∫/–∞–≤–∞—Ç–∞—Ä** ‚Äî –¥–æ–±–∞–≤–∏–ª –∫–æ–ª–æ–Ω–∫–∏ `username`, `avatar` –≤ —Ç–∞–±–ª–∏—Ü—É `users`
- **–°–¥–µ–ª–∫–∞ "–∑–∞–≤–∏—Å–∞–ª–∞"** ‚Äî –±–æ—Ç –Ω–µ –º–æ–≥ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ñ—Ñ–µ—Ä (Steam 502). –î–æ–±–∞–≤–∏–ª:
  - –°—Ç–∞—Ç—É—Å `error_sending` ‚Äî —Å–¥–µ–ª–∫–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –æ—à–∏–±–æ—á–Ω–∞—è
  - –ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É" ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç
  - –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å" ‚Äî –¥–µ–Ω—å–≥–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è, —Å–∫–∏–Ω –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è

### üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- Retry/Cancel —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã: `/api/escrow/trades/:uuid/retry` –∏ `/cancel`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–æ—Ç–∞ –Ω–µ –ª–æ–º–∞–µ—Ç —Å–¥–µ–ª–∫—É
- UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–Ω—è—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

---

## üìÅ –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `apps/backend/src/server.js` | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±—ç–∫–µ–Ω–¥–∞ |
| `apps/backend/src/routes/escrow.js` | –õ–æ–≥–∏–∫–∞ –ø–æ–∫—É–ø–æ–∫ –∏ —Å–¥–µ–ª–æ–∫ |
| `apps/backend/src/services/steam-bot.service.js` | –ö–ª–∞—Å—Å Steam-–±–æ—Ç–∞ |
| `apps/backend/src/routes/admin.js` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –±–æ—Ç–∞ |
| `apps/frontend/src/app/page.tsx` | –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ |
| `apps/frontend/src/app/trade/[tradeUuid]/page.tsx` | –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–¥–µ–ª–∫–∏ |
| `apps/frontend/src/lib/api.ts` | API-–∫–ª–∏–µ–Ω—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ |

---

## ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å

1. **Steam –±–æ—Ç—ã —Ç—Ä–µ–±—É—é—Ç Steam Guard Mobile Authenticator** (shared_secret, identity_secret).
2. **Steam API –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 502** ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞–∂–∞—Ç—å "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å".
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL** ‚Äî –Ω–µ SQLite, –Ω–µ MySQL.
4. **–¶–µ–Ω—ã ‚Äî –∑–∞–≥–ª—É—à–∫–∏** ‚Äî –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å API —Ü–µ–Ω (buff163, cs.money).

---

## ü§ù –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ ‚Äî –ø–∏—à–∏!

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ 16.12.2025*
